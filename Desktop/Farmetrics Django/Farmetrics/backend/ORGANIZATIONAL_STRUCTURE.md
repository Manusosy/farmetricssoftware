# Farmetrics - Organizational & Geographic Structure

## ğŸŒ Platform Hierarchy

### User Roles & Responsibilities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SUPER ADMIN                              â”‚
â”‚              (Platform Owner - Manages Everything)               â”‚
â”‚                                                                  â”‚
â”‚  â€¢ Manages Country Admins                                       â”‚
â”‚  â€¢ Platform-wide settings and configuration                     â”‚
â”‚  â€¢ Billing and subscription management                          â”‚
â”‚  â€¢ System-level reports and analytics                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚                  â”‚
        â–¼                                     â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COUNTRY ADMIN    â”‚              â”‚  COUNTRY ADMIN    â”‚  â”‚  COUNTRY... â”‚
â”‚     (Ghana)       â”‚              â”‚     (Kenya)       â”‚  â”‚             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ Manages all     â”‚              â”‚ â€¢ Manages all     â”‚
â”‚   Regional        â”‚              â”‚   Regional        â”‚
â”‚   Supervisors     â”‚              â”‚   Supervisors     â”‚
â”‚ â€¢ Approves new    â”‚              â”‚ â€¢ Approves new    â”‚
â”‚   accounts        â”‚              â”‚   accounts        â”‚
â”‚ â€¢ Assigns regions â”‚              â”‚ â€¢ Assigns regions â”‚
â”‚ â€¢ Approves        â”‚              â”‚ â€¢ Approves        â”‚
â”‚   transfers       â”‚              â”‚   transfers       â”‚
â”‚ â€¢ Country-level   â”‚              â”‚ â€¢ Country-level   â”‚
â”‚   analytics       â”‚              â”‚   analytics       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    â–¼           â–¼          â–¼          â–¼    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Regional â”‚ â”‚Regional  â”‚ â”‚Reg.  â”‚ â”‚Reg.  â”‚ â”‚Regional â”‚
â”‚Sup.     â”‚ â”‚Sup.      â”‚ â”‚Sup.  â”‚ â”‚Sup.  â”‚ â”‚Sup.     â”‚
â”‚(Ashanti)â”‚ â”‚(Greater  â”‚ â”‚(Brongâ”‚ â”‚(...) â”‚ â”‚(Nairobi)â”‚
â”‚         â”‚ â”‚ Accra)   â”‚ â”‚Ahafo)â”‚ â”‚      â”‚ â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚â€¢ Managesâ”‚ â”‚â€¢ Manages â”‚                   â”‚â€¢ Managesâ”‚
â”‚  Field  â”‚ â”‚  Field   â”‚                   â”‚  Field  â”‚
â”‚  Officersâ”‚ â”‚  Officersâ”‚                   â”‚  Officersâ”‚
â”‚â€¢ Views   â”‚ â”‚â€¢ Views   â”‚                   â”‚â€¢ Views   â”‚
â”‚  all     â”‚ â”‚  all     â”‚                   â”‚  all     â”‚
â”‚  districtsâ”‚ â”‚  districtsâ”‚                   â”‚  districtsâ”‚
â”‚  in regionâ”‚ â”‚  in regionâ”‚                   â”‚  in regionâ”‚
â”‚â€¢ Tracks  â”‚ â”‚â€¢ Tracks  â”‚                   â”‚â€¢ Tracks  â”‚
â”‚  field   â”‚ â”‚  field   â”‚                   â”‚  field   â”‚
â”‚  activityâ”‚ â”‚  activityâ”‚                   â”‚  activityâ”‚
â”‚â€¢ Can     â”‚ â”‚â€¢ Can     â”‚                   â”‚â€¢ Can     â”‚
â”‚  request â”‚ â”‚  request â”‚                   â”‚  request â”‚
â”‚  transferâ”‚ â”‚  transferâ”‚                   â”‚  transferâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚                              â”‚
  â”Œâ”€â”€â”´â”€â”€â”¬â”€â”€â”€â”€â”€â”  â”‚                              â”‚
  â–¼     â–¼     â–¼  â–¼                              â–¼
â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â” â”Œâ”€â”€â”€â”â”Œâ”€â”€â”€â”                        â”Œâ”€â”€â”€â”
â”‚FO â”‚ â”‚FO â”‚ â”‚FO â”‚â”‚FO â”‚                        â”‚FO â”‚
â”‚   â”‚ â”‚   â”‚ â”‚   â”‚â”‚   â”‚                        â”‚   â”‚
â”‚(District A)â”‚ â”‚(District B)                  â”‚(District X)
â”‚(Location 1)â”‚ â”‚(Location 2)                  â”‚(Location Y)
â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜ â””â”€â”€â”€â”˜â””â”€â”€â”€â”˜                        â””â”€â”€â”€â”˜

FO = Field Officer (Mobile App Only)
```

## ğŸ“ Geographic Hierarchy

### Structure
```
Country
  â””â”€â–º Region
      â””â”€â–º District
          â””â”€â–º Location/Community
```

### Example: Ghana
```
Ghana (Country - Level 0)
  â”‚
  â”œâ”€â–º Ashanti Region (Level 1)
  â”‚    â”œâ”€â–º Kumasi Metro (District - Level 2)
  â”‚    â”‚    â”œâ”€â–º Adum (Location - Level 3)
  â”‚    â”‚    â”œâ”€â–º Asokwa (Location - Level 3)
  â”‚    â”‚    â””â”€â–º Bantama (Location - Level 3)
  â”‚    â”‚
  â”‚    â”œâ”€â–º Obuasi Municipal (District - Level 2)
  â”‚    â”‚    â”œâ”€â–º Obuasi Town (Location - Level 3)
  â”‚    â”‚    â””â”€â–º Anyinam (Location - Level 3)
  â”‚    â”‚
  â”‚    â””â”€â–º Ejisu (District - Level 2)
  â”‚         â””â”€â–º Ejisu Town (Location - Level 3)
  â”‚
  â”œâ”€â–º Greater Accra Region (Level 1)
  â”‚    â”œâ”€â–º Accra Metro (District - Level 2)
  â”‚    â”‚    â”œâ”€â–º Osu (Location - Level 3)
  â”‚    â”‚    â”œâ”€â–º Labone (Location - Level 3)
  â”‚    â”‚    â””â”€â–º Cantonments (Location - Level 3)
  â”‚    â”‚
  â”‚    â””â”€â–º Tema (District - Level 2)
  â”‚         â””â”€â–º Tema Community 1 (Location - Level 3)
  â”‚
  â”œâ”€â–º Brong-Ahafo Region (Level 1)
  â”‚    â””â”€â–º (Districts and Locations...)
  â”‚
  â””â”€â–º (More Regions...)
```

### Example: Kenya (Future)
```
Kenya (Country - Level 0)
  â”‚
  â”œâ”€â–º Nairobi Region (Level 1)
  â”‚    â”œâ”€â–º Nairobi Central (District - Level 2)
  â”‚    â”‚    â””â”€â–º Locations...
  â”‚    â””â”€â–º Other Districts...
  â”‚
  â””â”€â–º Mombasa Region (Level 1)
       â””â”€â–º Districts and Locations...
```

## ğŸ” Permission Scoping

### Super Admin
- **Scope**: Entire platform (all countries)
- **Can See**: Everything
- **Can Manage**: 
  - All Country Admins
  - Platform settings
  - Billing and subscriptions
  - System-wide analytics

### Country Admin
- **Scope**: Single country (e.g., Ghana only)
- **Can See**: 
  - All regions, districts, locations in their country
  - All supervisors and field officers in their country
  - All farms and farmers in their country
- **Can Manage**:
  - Approve/reject new supervisor accounts
  - Assign supervisors to regions
  - Approve/reject transfer requests
  - Country-level analytics and reports
  - Regional supervisors

### Regional Supervisor
- **Scope**: Single region (e.g., Ashanti Region only)
- **Can See**:
  - All districts and locations within their region
  - All field officers assigned to their region
  - All farms and farmers in their region
  - All visits in their region
- **Can Manage**:
  - Field officers in their region
  - Approve/reject field officer requests
  - View field activity tracking
  - Regional analytics
- **Can Request**:
  - Transfer to another region (requires Admin approval)

### Field Officer (Mobile App Only)
- **Scope**: Assigned district(s) or location(s)
- **Can See**:
  - Farms and farmers in their assigned area
  - Their own visits and media uploads
- **Can Do**:
  - Create visits
  - Upload media
  - Edit assigned farmer/farm records
  - Submit requests (transfers, leave, etc.)
- **Cannot Access**: Web application

### Analyst
- **Scope**: Based on assignment (country, region, or organization-wide)
- **Can See**:
  - Analytics and reports for their scope
  - Farmers, farms, visits (read-only)
- **Cannot**:
  - Modify any data
  - Approve requests
  - Manage users

### Auditor
- **Scope**: Based on assignment
- **Can See**:
  - Audit logs
  - All data (read-only)
- **Cannot**:
  - Modify any data
  - Approve requests

## ğŸ”„ Account Creation & Assignment Workflow

### For Supervisors
1. **Supervisor creates account** via web app registration
2. **Status**: Account created but inactive
3. **Country Admin reviews** new account
4. **Country Admin approves** account
5. **Country Admin assigns** supervisor to a specific region
6. **Supervisor can now login** and see their region (all districts and locations)
7. **Supervisor sees dashboard** with:
   - All districts and locations in their region
   - All field officers assigned to their region
   - Field activity tracking
   - Regional analytics

### For Field Officers
1. **Field Officer creates account** via mobile app
2. **Status**: Account pending approval
3. **Country Admin (or delegated Supervisor) reviews**
4. **Country Admin approves** account
5. **Country Admin (or Supervisor) assigns** field officer to:
   - Specific district(s)
   - Specific location(s)
   - Specific supervisor
6. **Field Officer can now use mobile app** for assigned areas

## ğŸ“‹ Transfer Request Workflow

### Supervisor Transfer Request
1. **Supervisor requests transfer** to different region
2. **Request includes**: Target region, reason
3. **Country Admin receives notification**
4. **Country Admin reviews** request
5. **Country Admin approves or declines**
6. If approved:
   - Supervisor is reassigned to new region
   - All their field officers remain in old region
   - Access scope changes to new region

### Field Officer Transfer Request
1. **Field Officer requests transfer** via mobile app
2. **Current Supervisor receives notification**
3. **Supervisor approves/declines** (or escalates to Admin)
4. If approved:
   - Field officer reassigned to new area
   - Historical data remains accessible

## ğŸ—ºï¸ Dashboard Views

### Country Admin Dashboard
```
Ghana Dashboard
â”œâ”€ Total Regions: 16
â”œâ”€ Total Districts: 260
â”œâ”€ Total Supervisors: 45
â”œâ”€ Total Field Officers: 1,200
â”œâ”€ Total Farms: 25,000
â”œâ”€ Total Farmers: 18,000
â”œâ”€ Recent Activities
â”œâ”€ Pending Approvals (New accounts, transfers)
â”œâ”€ Country-wide Analytics
â””â”€ Regional Performance Comparison
```

### Regional Supervisor Dashboard (e.g., Ashanti Region)
```
Ashanti Region Dashboard
â”œâ”€ Districts: 43
â”œâ”€ Locations: 350+
â”œâ”€ Field Officers: 180 (assigned to me)
â”œâ”€ Active Farms: 4,200
â”œâ”€ Active Farmers: 3,100
â”œâ”€ Recent Visits: Last 7 days
â”œâ”€ Field Officer Activity Tracking
â”‚   â”œâ”€ Officer A: 15 visits (Kumasi Metro)
â”‚   â”œâ”€ Officer B: 12 visits (Obuasi Municipal)
â”‚   â””â”€ Officer C: 8 visits (Ejisu)
â”œâ”€ Pending Requests (from my field officers)
â””â”€ Regional Analytics
```

### Field Officer View (Mobile - e.g., Kumasi Metro)
```
My Assignments
â”œâ”€ District: Kumasi Metro
â”œâ”€ Locations: Adum, Asokwa, Bantama
â”œâ”€ My Farms: 85
â”œâ”€ My Farmers: 62
â”œâ”€ My Visits This Week: 12
â”œâ”€ Pending Tasks
â””â”€ Create New Visit
```

## ğŸ’¾ Database Implementation

### Region Model Updates Needed
- `level_type` field: 'country', 'region', 'district', 'location'
- Proper hierarchy validation
- Country-specific region codes

### User/Role Updates Needed
- Country Admin role distinct from Super Admin
- Country assignment for Country Admins
- Region assignment for Supervisors
- District/Location assignment for Field Officers

### Assignment Models Needed
- `UserAssignment` model:
  - User FK
  - Geographic scope (country/region/district/location)
  - Assignment type (permanent/temporary)
  - Assigned by, assigned at

## ğŸ¯ Key Implementation Changes

1. **Update Role Model** to include:
   - `country_admin` role (distinct from `super_admin`)
   - Proper permission scoping

2. **Update RegionSupervisor** to:
   - Include assignment approval workflow
   - Track transfer history

3. **Create Geographic Assignment Model**:
   - Links users to specific geographic scopes
   - Tracks assignment history

4. **Update Middleware**:
   - Set geographic scope based on user role
   - Filter queries by scope automatically

5. **Create Transfer Request Module**:
   - Transfer request model
   - Approval workflow
   - Notification system

---

**Does this match your vision perfectly?** This structure ensures:
- âœ… Super Admin manages the platform
- âœ… Country Admins manage their country
- âœ… Supervisors manage their region (seeing all districts/locations)
- âœ… Field Officers work in assigned areas via mobile
- âœ… Proper approval workflows for accounts and transfers
- âœ… Scoped dashboards showing relevant data only

